# 数据库视图说明文档

本文档描述了系统中的主要数据库视图及其用途。

## 正编人员工资信息表

### 描述

`正编人员工资信息表` 视图包含正编人员（公务员、参公和事业编制）的薪资信息。正编人员通过 `sal_employee_type_key` 字段识别，包括公务员(gwy)、参公(cg)和事业编制(sy)。

### 主要字段

#### 基本信息
- `薪酬周期`: 薪资发放的周期标识，通常为年月格式（如 "2023-12"）
- `姓名`: 员工姓名
- `编制`: 员工编制类型，通过关联 `establishment_types` 表获取
- `人员身份`: 员工的人员身份
- `职务级别`: 员工的职务级别
- `是否领导`: 是否为领导职务

#### 薪资信息
- `职务/岗位工资`: 基于职务或岗位的基本工资
- `级别/薪级工资`: 基于级别或薪级的工资
- `试用期工资`: 试用期期间的工资
- `93年工改保留补贴`: 1993年工资改革后保留的补贴
- `独生子女父母奖励金`: 独生子女父母的奖励金
- `岗位职务津贴`: 特定岗位或职务的津贴
- `信访工作人员岗位津贴`: 信访工作人员的特殊岗位津贴
- `基础绩效奖`: 基础绩效奖金
- `公务员规范性津贴补贴`: 公务员的规范性津贴
- `公务交通补贴`: 交通相关的补贴

#### 社保信息
- `医疗保险个人应缴总额`: 个人应缴纳的医疗保险总额
- `养老保险个人应缴金额`: 个人应缴纳的养老保险金额
- `职业年金个人应缴费额`: 个人应缴纳的职业年金金额
- `住房公积金个人应缴费额`: 个人应缴纳的住房公积金金额
- `其他扣款`: 其他各类扣款

#### 统计字段
- `应发工资`: 所有薪资项目的总和
- `扣发合计`: 所有扣除项目的总和
- `实发工资`: 应发工资减去扣发合计

### 使用示例

```sql
-- 查看特定薪酬周期的正编人员工资信息
SELECT * FROM public.正编人员工资信息表 
WHERE "薪酬周期" = '2023-12'
ORDER BY "姓名";

-- 按编制类型分组统计
SELECT 
    "编制",
    COUNT(*) AS "人数",
    AVG("应发工资") AS "平均应发工资",
    AVG("实发工资") AS "平均实发工资"
FROM 
    public.正编人员工资信息表
WHERE 
    "薪酬周期" = '2023-12'
GROUP BY 
    "编制"
ORDER BY 
    "平均应发工资" DESC;
```

## 聘用人员工资信息表

### 描述

`聘用人员工资信息表` 视图包含非正编人员的薪资信息。聘用人员通过排除 `sal_employee_type_key` 字段中的正编人员类型（gwy、cg、sy）来识别。

### 主要字段

#### 基本信息
- `薪酬周期`: 薪资发放的周期标识，通常为年月格式（如 "2023-12"）
- `姓名`: 员工姓名
- `编制`: 员工编制类型，通过关联 `establishment_types` 表获取

#### 人员信息
- `岗位类别`: 员工的岗位类别
- `工资级别`: 员工的工资级别
- `工资档次`: 员工的工资档次
- `参照正编薪级工资级次`: 参照正编人员的薪级工资级次

#### 薪资信息
- `基本工资`: 员工的基本工资
- `岗位工资`: 基于岗位的工资
- `绩效工资`: 绩效相关的工资
- `补助`: 各类补助
- `信访岗位津贴`: 信访岗位的特殊津贴
- `基础绩效奖`: 基础绩效奖金

#### 社保信息
- `医疗保险个人应缴总额`: 个人应缴纳的医疗保险总额
- `养老保险个人应缴金额`: 个人应缴纳的养老保险金额
- `职业年金个人应缴费额`: 个人应缴纳的职业年金金额
- `住房公积金个人应缴费额`: 个人应缴纳的住房公积金金额
- `其他扣款`: 其他各类扣款

#### 统计字段
- `工资小计`: 基本工资、岗位工资、绩效工资、信访岗位津贴和基础绩效奖的总和
- `发放合计`: 工资小计加上补助
- `扣发合计`: 所有扣除项目的总和
- `实发工资`: 发放合计减去扣发合计

### 使用示例

```sql
-- 查看特定薪酬周期的聘用人员工资信息
SELECT * FROM public.聘用人员工资信息表 
WHERE "薪酬周期" = '2023-12'
ORDER BY "姓名";

-- 按岗位类别分组统计
SELECT 
    "岗位类别",
    COUNT(*) AS "人数",
    AVG("工资小计") AS "平均工资小计",
    AVG("发放合计") AS "平均发放合计",
    AVG("实发工资") AS "平均实发工资"
FROM 
    public.聘用人员工资信息表
WHERE 
    "薪酬周期" = '2023-12'
GROUP BY 
    "岗位类别"
ORDER BY 
    "平均工资小计" DESC;
```

## 字段命名规则

系统中的字段命名遵循以下规则：

1. 原始导入表中的字段使用原始名称，如 `raw_medical_staging` 表中的 `medical_total_employee_contribution`

2. 合并表 `consolidated_data` 中的字段添加来源表前缀，如：
   - `med_` 前缀表示来自医疗保险数据
   - `pen_` 前缀表示来自养老保险数据
   - `hf_` 前缀表示来自住房公积金数据
   - `ann_` 前缀表示来自年金数据
   - `sal_` 前缀表示来自薪资数据
   - `tax_` 前缀表示来自税务数据

3. 视图中的字段使用中文名称，便于用户理解和使用
