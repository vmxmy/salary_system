"""fresh_initial_schema_v4_corrected_include

Revision ID: 65e1e15b895f
Revises: 
Create Date: 2025-05-06 23:01:36.821236

"""
from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision: str = '65e1e15b895f'
down_revision: Union[str, None] = None
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


def upgrade() -> None:
    """Upgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('consolidated_data',
    sa.Column('_consolidated_data_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('employee_name', sa.String(), nullable=False),
    sa.Column('pay_period_identifier', sa.String(), nullable=False),
    sa.Column('id_card_number', sa.String(), nullable=True),
    sa.Column('ann_contribution_base_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('ann_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('ann_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('ann_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('ann_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('ann_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('hf_contribution_base_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('hf_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('hf_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('hf_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('hf_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('hf_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_contribution_base_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_employer_medical_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('med_employer_medical_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_employee_medical_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('med_employee_medical_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_employer_critical_illness_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('med_employer_critical_illness_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_total_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('med_total_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_pension_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_pension_total_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_pension_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pen_pension_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_pension_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pen_pension_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_unemployment_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_unemployment_total_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_unemployment_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pen_unemployment_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_unemployment_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pen_unemployment_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_injury_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_injury_total_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_injury_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pen_injury_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_ss_total_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pen_ss_total_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_remarks', sa.Text(), nullable=True),
    sa.Column('sal_subsidy', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_post_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_salary_step', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_basic_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_tax_adjustment', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_salary_grade', sa.String(), nullable=True),
    sa.Column('sal_salary_level', sa.String(), nullable=True),
    sa.Column('sal_salary_backpay', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_post_category', sa.String(), nullable=True),
    sa.Column('sal_other_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_other_deductions', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employee_type_key', sa.String(), nullable=True),
    sa.Column('sal_personnel_rank', sa.String(), nullable=True),
    sa.Column('sal_living_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_probation_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_one_time_deduction', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_performance_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_personnel_identity', sa.String(), nullable=True),
    sa.Column('sal_total_backpay_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_individual_income_tax', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_housing_fund_adjustment', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_basic_performance_bonus', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_petition_post_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_post_position_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_transportation_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_self_annuity_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_self_medical_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_self_pension_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_monthly_basic_performance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_only_child_parents_reward', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_rank_or_post_grade_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_salary_step_backpay_total', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_ref_official_salary_step', sa.String(), nullable=True),
    sa.Column('sal_monthly_reward_performance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_total_deduction_adjustment', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_social_insurance_adjustment', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_quarterly_performance_bonus', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_annual_fixed_salary_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_position_or_technical_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_reform_1993_reserved_subsidy', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_reward_performance_deduction', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_annuity_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_medical_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_pension_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_self_housing_fund_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_self_unemployment_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_petition_worker_post_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_ref_official_post_salary_level', sa.String(), nullable=True),
    sa.Column('sal_basic_performance_bonus_deduction', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_civil_servant_normative_allowance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_housing_fund_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_unemployment_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_critical_illness_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_bank_account_number', sa.Text(), nullable=True),
    sa.Column('sal_bank_branch_name', sa.Text(), nullable=True),
    sa.Column('sal_employment_start_date', sa.Date(), nullable=True),
    sa.Column('sal_employment_status', sa.Text(), nullable=True),
    sa.Column('sal_organization_name', sa.Text(), nullable=True),
    sa.Column('sal_department_name', sa.Text(), nullable=True),
    sa.Column('sal_basic_performance_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_incentive_performance_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_self_injury_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_employer_injury_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_salary_position_or_post_wage', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_salary_rank_or_step_wage', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('sal_is_leader', sa.Boolean(), nullable=True),
    sa.Column('sal_pay_period', sa.Date(), nullable=True),
    sa.Column('tax_period_identifier', sa.String(), nullable=True),
    sa.Column('tax_income_period_start', sa.Date(), nullable=True),
    sa.Column('tax_income_period_end', sa.Date(), nullable=True),
    sa.Column('tax_current_period_income', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_current_period_tax_exempt_income', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_basic_pension', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_basic_medical', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_unemployment', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_housing_fund', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_child_edu_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_cont_edu_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_housing_loan_interest_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_housing_rent_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_support_elderly_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_infant_care_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_private_pension_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_annuity', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_commercial_health_insurance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_deferred_pension_insurance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_other', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_deduction_donations', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_total_deductions_pre_tax', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_reduction_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_standard_deduction', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_calculated_income_tax', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('tax_remarks', sa.Text(), nullable=True),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_consolidation_timestamp', postgresql.TIMESTAMP(timezone=True), nullable=False),
    sa.PrimaryKeyConstraint('_consolidated_data_id'),
    sa.UniqueConstraint('employee_name', 'pay_period_identifier', name='uq_consolidated_employee_period'),
    schema='staging'
    )
    op.create_table('raw_annuity_staging',
    sa.Column('_annuity_staging_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('id_card_number', sa.String(), nullable=True),
    sa.Column('pay_period_identifier', sa.String(length=7), nullable=False),
    sa.Column('employee_name', sa.Text(), nullable=True),
    sa.Column('annuity_contribution_base_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('annuity_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('annuity_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('annuity_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('annuity_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('annuity_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('_source_filename', sa.Text(), nullable=True),
    sa.Column('_source_sheet_name', sa.Text(), nullable=True),
    sa.Column('_row_number', sa.Integer(), nullable=True),
    sa.Column('_import_timestamp', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_validation_status', sa.String(length=50), nullable=False),
    sa.Column('_validation_errors', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('employee_type_key', sa.String(length=50), nullable=True),
    sa.PrimaryKeyConstraint('_annuity_staging_id'),
    schema='staging'
    )
    op.create_table('raw_housingfund_staging',
    sa.Column('_housingfund_staging_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('id_card_number', sa.String(), nullable=True),
    sa.Column('pay_period_identifier', sa.String(length=7), nullable=False),
    sa.Column('employee_name', sa.Text(), nullable=True),
    sa.Column('housingfund_contribution_base_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('housingfund_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('housingfund_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('housingfund_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('housingfund_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('housingfund_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('_source_filename', sa.Text(), nullable=True),
    sa.Column('_source_sheet_name', sa.Text(), nullable=True),
    sa.Column('_row_number', sa.Integer(), nullable=True),
    sa.Column('_import_timestamp', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_validation_status', sa.String(length=50), nullable=False),
    sa.Column('_validation_errors', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('employee_type_key', sa.String(length=50), nullable=True),
    sa.PrimaryKeyConstraint('_housingfund_staging_id'),
    schema='staging'
    )
    op.create_table('raw_medical_staging',
    sa.Column('_medical_staging_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('id_card_number', sa.String(), nullable=True),
    sa.Column('pay_period_identifier', sa.String(length=7), nullable=False),
    sa.Column('employee_name', sa.Text(), nullable=True),
    sa.Column('contribution_base_salary', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('employer_medical_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('employer_medical_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('employee_medical_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('employee_medical_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('employer_critical_illness_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('employer_critical_illness_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('total_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('total_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('_source_filename', sa.Text(), nullable=True),
    sa.Column('_source_sheet_name', sa.Text(), nullable=True),
    sa.Column('_row_number', sa.Integer(), nullable=True),
    sa.Column('_import_timestamp', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_validation_status', sa.String(length=50), nullable=False),
    sa.Column('_validation_errors', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('employee_type_key', sa.String(length=50), nullable=True),
    sa.PrimaryKeyConstraint('_medical_staging_id'),
    schema='staging'
    )
    op.create_table('raw_pension_staging',
    sa.Column('_pension_staging_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('id_card_number', sa.String(), nullable=True),
    sa.Column('pay_period_identifier', sa.String(length=7), nullable=False),
    sa.Column('employee_name', sa.Text(), nullable=True),
    sa.Column('pension_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pension_total_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pension_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pension_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('pension_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('pension_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('unemployment_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('unemployment_total_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('unemployment_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('unemployment_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('unemployment_employee_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('unemployment_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('injury_contribution_base', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('injury_total_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('injury_employer_rate', sa.Numeric(precision=5, scale=4), nullable=True),
    sa.Column('injury_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('ss_total_employer_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('ss_total_employee_contribution', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('_source_filename', sa.Text(), nullable=True),
    sa.Column('_source_sheet_name', sa.Text(), nullable=True),
    sa.Column('_row_number', sa.Integer(), nullable=True),
    sa.Column('_import_timestamp', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_validation_status', sa.String(length=50), nullable=False),
    sa.Column('_validation_errors', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('employee_type_key', sa.String(length=50), nullable=True),
    sa.PrimaryKeyConstraint('_pension_staging_id'),
    schema='staging'
    )
    op.create_table('raw_salary_data_staging',
    sa.Column('_staging_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('id_card_number', sa.String(length=18), nullable=True),
    sa.Column('employee_name', sa.Text(), nullable=True),
    sa.Column('employee_unique_id', sa.Text(), nullable=True),
    sa.Column('establishment_type_name', sa.Text(), nullable=True),
    sa.Column('pay_period_identifier', sa.String(length=7), nullable=False),
    sa.Column('job_attr_人员身份', sa.Text(), nullable=True),
    sa.Column('job_attr_人员职级', sa.Text(), nullable=True),
    sa.Column('job_attr_岗位类别', sa.Text(), nullable=True),
    sa.Column('job_attr_参照正编岗位工资级别', sa.Text(), nullable=True),
    sa.Column('job_attr_参照正编薪级工资级次', sa.Text(), nullable=True),
    sa.Column('job_attr_工资级别', sa.Text(), nullable=True),
    sa.Column('job_attr_工资档次', sa.Text(), nullable=True),
    sa.Column('job_attr_固定薪酬全年应发数', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_一次性补扣发', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_基础绩效奖补扣发', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_职务技术等级工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_级别岗位级别工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_93年工改保留补贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_独生子女父母奖励金', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_岗位职务补贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_公务员规范性津贴补贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_公务交通补贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_基础绩效奖', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_见习试用期工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_信访工作人员岗位津贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_奖励绩效补扣发', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_岗位工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_薪级工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_月基础绩效', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_月奖励绩效', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_基本工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_绩效工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_其他补助', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_补发工资', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_津贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_季度绩效考核薪酬', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_补助', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_信访岗位津贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_补扣发合计', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_生活津贴', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_1季度3季度考核绩效奖', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('salary_补发薪级合计', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_个人缴养老保险费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_个人缴医疗保险费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_个人缴职业年金', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_个人缴住房公积金', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_个人缴失业保险费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_个人所得税', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_其他扣款', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_补扣退社保缴费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_补扣退公积金', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('deduct_补扣个税', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('contrib_单位缴养老保险费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('contrib_单位缴医疗保险费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('contrib_单位缴职业年金', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('contrib_单位缴住房公积金', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('contrib_单位缴失业保险费', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('contrib_大病医疗单位缴纳', sa.Numeric(precision=12, scale=2), nullable=True),
    sa.Column('other_备注', sa.Text(), nullable=True),
    sa.Column('_source_filename', sa.Text(), nullable=True),
    sa.Column('_source_sheet_name', sa.Text(), nullable=True),
    sa.Column('_row_number', sa.Integer(), nullable=True),
    sa.Column('_import_timestamp', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_validation_status', sa.String(length=50), nullable=False),
    sa.Column('_validation_errors', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('employee_type_key', sa.String(length=50), nullable=True),
    sa.PrimaryKeyConstraint('_staging_id'),
    schema='staging'
    )
    op.create_table('raw_tax_staging',
    sa.Column('_tax_staging_id', sa.Integer(), sa.Identity(always=False, start=1), nullable=False),
    sa.Column('id_card_number', sa.String(), nullable=True),
    sa.Column('pay_period_identifier', sa.String(length=7), nullable=False),
    sa.Column('employee_name', sa.Text(), nullable=True),
    sa.Column('income_period_start', sa.Date(), nullable=True),
    sa.Column('income_period_end', sa.Date(), nullable=True),
    sa.Column('current_period_income', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('current_period_tax_exempt_income', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_basic_pension', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_basic_medical', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_unemployment', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_housing_fund', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_child_edu_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_cont_edu_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_housing_loan_interest_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_housing_rent_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_support_elderly_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_infant_care_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_private_pension_cumulative', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_annuity', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_commercial_health_insurance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_deferred_pension_insurance', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_other', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('deduction_donations', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('total_deductions_pre_tax', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('reduction_amount', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('standard_deduction', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('calculated_income_tax', sa.Numeric(precision=15, scale=2), nullable=True),
    sa.Column('remarks', sa.Text(), nullable=True),
    sa.Column('_source_filename', sa.Text(), nullable=True),
    sa.Column('_source_sheet_name', sa.Text(), nullable=True),
    sa.Column('_row_number', sa.Integer(), nullable=True),
    sa.Column('_import_timestamp', postgresql.TIMESTAMP(timezone=True), server_default=sa.text('now()'), nullable=False),
    sa.Column('_import_batch_id', sa.UUID(), nullable=False),
    sa.Column('_validation_status', sa.String(length=50), nullable=False),
    sa.Column('_validation_errors', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
    sa.Column('employee_type_key', sa.String(length=50), nullable=True),
    sa.PrimaryKeyConstraint('_tax_staging_id'),
    schema='staging'
    )
    op.drop_table_comment(
        'employee_type_field_rules',
        existing_comment='Defines which salary fields apply to which employee types and whether they are required. References establishment_types and salary_field_mappings.',
        schema='core'
    )
    op.drop_table_comment(
        'sheet_name_mappings',
        existing_comment='Maps specific Excel sheet names to the internal employee_type_key used for configuration.',
        schema='core'
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    """Downgrade schema."""
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table_comment(
        'sheet_name_mappings',
        'Maps specific Excel sheet names to the internal employee_type_key used for configuration.',
        existing_comment=None,
        schema='core'
    )
    op.create_table_comment(
        'employee_type_field_rules',
        'Defines which salary fields apply to which employee types and whether they are required. References establishment_types and salary_field_mappings.',
        existing_comment=None,
        schema='core'
    )
    op.drop_table('raw_tax_staging', schema='staging')
    op.drop_table('raw_salary_data_staging', schema='staging')
    op.drop_table('raw_pension_staging', schema='staging')
    op.drop_table('raw_medical_staging', schema='staging')
    op.drop_table('raw_housingfund_staging', schema='staging')
    op.drop_table('raw_annuity_staging', schema='staging')
    op.drop_table('consolidated_data', schema='staging')
    # ### end Alembic commands ###
